# Non-secret network settings tracked in plaintext.

# --- Global Settings ---
wifi_country: 'GB'
garage_mgmt_ssid: 'homelab_garage_mngmt'
garage_wifi_radios_to_disable:
  - radio0
  - radio1
garage_test_mode: true
garage_test_repeater_network: 'wwan'
garage_test_repeater_radio: 'radio1'
garage_test_repeater_encryption: 'sae'
garage_test_repeater_radios:
  - 'radio1'
  - 'radio0'
  - 'radio2'
garage_test_repeater_encryptions:
  - 'sae'
  - 'sae-mixed'
  - 'psk2'
  - 'psk-mixed'
garage_test_tailscale_hosts:
  - 'login.tailscale.com'
  - 'api.tailscale.com'
garage_test_uplink_wait_seconds: 90
garage_test_uplink_poll_interval_seconds: 5
garage_wan_proto: 'pppoe'
garage_wan_pppoe_mtu: '1492'
garage_wan_vlan_tag: '911'
# Optional WAN parent interface override; leave empty to auto-detect from current network.wan.device.
garage_wan_parent_if: ''
# Optional if your ISP requires it; keep empty otherwise.
garage_wan_pppoe_service: ''
tailscale_enable: true
# Garage profile defaults: announce internal subnets and publish as an exit node.
# These can be overridden in any tailscale component playbook.
tailscale_advertise_routes:
  - '10.10.0.0/24'
  - '10.20.0.0/24'
# Use '-' for the current tailnet associated with the OAuth client.
tailscale_oauth_tailnet: '-'
tailscale_oauth_tags:
  - 'tag:router-garage'
tailscale_oauth_key_expiry_seconds: 7776000

# --- VLAN Schema ---
vlans:
  - { id: 10, name: 'servers', ip: '10.10.0.1', zone: 'server_zone' }
  - { id: 20, name: 'trusted', ip: '10.20.0.1', zone: 'trusted_zone' }
  - { id: 30, name: 'iot', ip: '10.30.0.1', zone: 'iot_zone' }
  - { id: 99, name: 'guest', ip: '10.99.0.1', zone: 'guest_zone' }

# --- WiFi Configuration (Office AP profile) ---
# Matches README SSIDs/VLANs:
# - Meerkat Manor -> VLAN 20
# - Meerkat IoT -> VLAN 30
# - Meerkat Guest -> VLAN 99
ssids:
  - name: 'manor_5g'
    ssid: 'Meerkat Manor'
    vlan_id: 20
    key: "{{ vault_wifi_key_manor }}"
    device: 'radio1'
    encryption: 'sae'
  - name: 'manor_6g'
    ssid: 'Meerkat Manor'
    vlan_id: 20
    key: "{{ vault_wifi_key_manor }}"
    device: 'radio2'
    encryption: 'sae'
  - name: 'iot_2g'
    ssid: 'Meerkat IoT'
    vlan_id: 30
    key: "{{ vault_wifi_key_iot }}"
    device: 'radio0'
    encryption: 'psk2'
  - name: 'guest_2g'
    ssid: 'Meerkat Guest'
    vlan_id: 99
    key: "{{ vault_wifi_key_guest }}"
    device: 'radio0'
    encryption: 'psk-mixed'
    isolate: '1'
  - name: 'guest_5g'
    ssid: 'Meerkat Guest'
    vlan_id: 99
    key: "{{ vault_wifi_key_guest }}"
    device: 'radio1'
    encryption: 'psk-mixed'
    isolate: '1'

forwarding_rules:
  - { src: 'trusted_zone', dest: 'server_zone' }
  - { src: 'trusted_zone', dest: 'wan' }
  - { src: 'server_zone', dest: 'wan' }
  - { src: 'iot_zone', dest: 'wan' }
  - { src: 'guest_zone', dest: 'wan' }


# --- AdGuard Home (garage router) ---
adguard_enable: false
adguard_admin_port: 3000
adguard_dns_port: 53
adguard_upstream_dns:
  - 'https://dns10.quad9.net/dns-query'
  - 'https://1.1.1.1/dns-query'
adguard_bootstrap_dns:
  - '9.9.9.9'
  - '1.1.1.1'

# --- WireGuard + VLAN policy routing (garage router) ---
# Enable once you populate credentials in Vault and endpoint details below.
wireguard_policy_enable: false
wireguard_policy_connections:
  - name: 'surfshark_london'
    private_key: "{{ vault_wireguard_private_key_london | default('') }}"
    endpoint_host: 'uk-lon.prod.surfshark.com'
    endpoint_port: 51820
    public_key: "{{ vault_wireguard_public_key_london | default('') }}"
    preshared_key: "{{ vault_wireguard_preshared_key_london | default('') }}"
    allowed_ips:
      - '0.0.0.0/0'
    addresses:
      - '10.14.0.2/16'
  - name: 'surfshark_amsterdam'
    private_key: "{{ vault_wireguard_private_key_amsterdam | default('') }}"
    endpoint_host: 'nl-ams.prod.surfshark.com'
    endpoint_port: 51820
    public_key: "{{ vault_wireguard_public_key_amsterdam | default('') }}"
    preshared_key: "{{ vault_wireguard_preshared_key_amsterdam | default('') }}"
    allowed_ips:
      - '0.0.0.0/0'
    addresses:
      - '10.15.0.2/16'

# Map local VLAN subnets to specific VPN tunnels.
# Example: IoT (TVs) to Amsterdam, everyone else to London.
wireguard_policy_vlan_map:
  - name: 'iot_to_amsterdam'
    vlan_zone: 'iot_zone'
    subnet: '10.30.0.0/24'
    connection_name: 'surfshark_amsterdam'
  - name: 'trusted_to_london'
    vlan_zone: 'trusted_zone'
    subnet: '10.20.0.0/24'
    connection_name: 'surfshark_london'
  - name: 'servers_to_london'
    vlan_zone: 'server_zone'
    subnet: '10.10.0.0/24'
    connection_name: 'surfshark_london'
  - name: 'guest_to_london'
    vlan_zone: 'guest_zone'
    subnet: '10.99.0.0/24'
    connection_name: 'surfshark_london'
